import{_ as oe}from"./CRWhLXmG.js";import{_ as ae,l as le,e as A,q as b,f as ce,c,a as s,b as Y,w as E,h as v,t as w,F as ue,r as de,j as f,o as l,d as pe,A as ge,i as fe}from"./BP8Zqz1I.js";import{u as me}from"./EIUoMLvZ.js";const he={class:"blog-detail-page"},ye={class:"content"},ve={key:0,class:"loading-state"},we={key:1,class:"error-state"},Se={key:2,class:"not-found-state"},_e={key:3,class:"blog-article"},ke={class:"article-nav"},$e={key:0,class:"featured-image"},Ie=["src","alt"],xe={class:"article-content"},Ue={class:"article-title"},Pe={class:"article-meta"},Te={key:0,class:"meta-date"},Ce={key:1,class:"meta-separator"},Re={key:2,class:"meta-reading-time"},Ae=["innerHTML"],Be={key:4,class:"related-products-section"},Ne={class:"products-carousel-wrapper"},Oe={class:"product-image"},Ve=["src","alt"],be={key:0,class:"discount-badge"},Ee={class:"product-info"},Le={class:"product-name"},Ke={class:"product-price"},je={__name:"[title]",setup(Fe){const L=le(),K=fe(),S=A(()=>String(K.public.apiBase||"").replace(/\/$/,"")),r=f(null),_=f(!0),x=f(null),p=f([]),B=f(!1),j=f(null),G=f(null),U=A(()=>{const e=L.params.id;return e?parseInt(String(e),10):null}),N=async()=>{if(!U.value){x.value=new Error("Blog ID is required"),_.value=!1;return}try{_.value=!0,x.value=null;const e=await $fetch(`/blog/${U.value}`,{baseURL:S.value});r.value=e,_.value=!1,e.collectionCategory&&F(e.collectionCategory)}catch(e){console.error("[Blog Detail] Fetch error:",e),x.value=e,_.value=!1,r.value=null}},F=async e=>{if(e)try{B.value=!0,j.value=null;const t=await $fetch(`/collections/type/${e}`,{baseURL:S.value});p.value=(Array.isArray(t)?t:[]).map(i=>{const u=(i.images?.find(P=>P.catalogImage)||i.images?.[0])?.imageUrl||i.image||"",g=i.discounts?.enable?Number(i.discounts.discount||0):0;return{id:i.id,name:i.name||"Product",price:Number(i.price||0),image:u,discountPercent:g>0?g:null,raw:i}}),B.value=!1}catch(t){console.error("[Blog Detail] Fetch related products error:",t),j.value=t,B.value=!1,p.value=[]}};A(()=>!r.value||!r.value.tags?[]:Array.isArray(r.value.tags)?r.value.tags:typeof r.value.tags=="string"?r.value.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]),b(()=>L.params.id,()=>{U.value&&N()},{immediate:!0}),b(()=>r.value?.collectionCategory,e=>{e?F(e):p.value=[]}),ce(()=>{U.value&&N()});const X=()=>{N()},k=e=>{const t=String(e||"").trim();if(!t)return"";if(t.includes("localhost:9090")||t.includes("localhost:"))try{const i=new URL(t),o=i.pathname+i.search;return`${S.value}${o}`}catch{const i=t.match(/localhost:\d+(\/.*)/);return i?`${S.value}${i[1]}`:t}return t.startsWith("http://")||t.startsWith("https://")?t:t.startsWith("/")?`${S.value}${t}`:t},Z=e=>{if(!e)return"";let t=String(e);return t=t.replace(/<img>\s*\{?\s*([^<{}]+?)\s*\}?\s*<\/img>/gi,(i,o)=>{const u=k(o.trim());return u?`<img src="${u.replace(/"/g,"&quot;")}" alt="" style="max-width: 100%; height: auto; display: block; margin: 2rem 0;" loading="lazy" />`:""}),t=t.replace(/<br\s*\/?>/gi,"<br />"),t=t.replace(/<bold>\s*\{?\s*([^<{}]+?)\s*\}?\s*<\/bold>/gi,"<strong>$1</strong>"),t=t.replace(/<b>\s*\{?\s*([^<{}]+?)\s*\}?\s*<\/b>/gi,"<strong>$1</strong>"),t},D=A(()=>!r.value||!r.value.content?"":Z(r.value.content)),ee=e=>{if(!e)return"";try{const t=new Date(e),i=t.toLocaleString("en-US",{month:"long"}).toUpperCase(),o=t.getDate(),u=t.getFullYear(),g=te(o);return`${i} ${o}${g}, ${u}`}catch{return""}},te=e=>{if(e>=11&&e<=13)return"TH";switch(e%10){case 1:return"ST";case 2:return"ND";case 3:return"RD";default:return"TH"}},ne=async()=>{if(navigator.share&&r.value)try{await navigator.share({title:r.value.title,text:r.value.metaDescription||"",url:window.location.href})}catch{}else try{await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")}catch{}},m=(e,t)=>e&&String(e).trim()!==""?String(e).trim():t;b([()=>r.value,()=>p.value],([e,t])=>{if(!e)return;const i=m(e.seoTitle,e.title?`${e.title} | SVRVE Blog`:"Blog | SVRVE"),o=m(e.metaDescription,e.content?e.content.substring(0,160).replace(/<[^>]*>/g,""):"Read our latest blog post on SVRVE."),u=m(e.ogTitle,i),g=m(e.ogDescription,o),P=m(e.ogImageUrl,e.featuredImageUrl?k(e.featuredImageUrl):""),M=m(e.canonicalUrl,typeof window<"u"?window.location.href:""),d=[{name:"description",content:o}];if(e.primaryKeyword&&String(e.primaryKeyword).trim()!==""){const n=[String(e.primaryKeyword).trim()];e.secondaryKeywords&&String(e.secondaryKeywords).trim()!==""&&n.push(String(e.secondaryKeywords).trim()),d.push({name:"keywords",content:n.join(", ")})}if(d.push({property:"og:title",content:u}),d.push({property:"og:description",content:g}),d.push({property:"og:type",content:"article"}),P&&d.push({property:"og:image",content:P}),e.publishedAt&&d.push({property:"article:published_time",content:new Date(e.publishedAt).toISOString()}),e.indexStatus&&String(e.indexStatus).trim()!==""){const n=String(e.indexStatus).trim().toLowerCase();(n==="noindex"||n==="noindex, nofollow")&&d.push({name:"robots",content:n})}const h=K.public.siteUrl||(typeof window<"u"?window.location.origin:""),se=typeof window<"u"?window.location.href:`${h}/blog/${e.id}/${z(e.title)}`,q=e.featuredImageUrl?k(e.featuredImageUrl):"",W=e.content?e.content.replace(/<[^>]*>/g,"").split(/\s+/).length:0,T=[];if(e.primaryKeyword&&String(e.primaryKeyword).trim()!==""&&T.push(String(e.primaryKeyword).trim()),e.secondaryKeywords&&String(e.secondaryKeywords).trim()!==""){const n=String(e.secondaryKeywords).trim().split(",").map(y=>y.trim()).filter(y=>y);T.push(...n)}let C=[];e.tags&&(Array.isArray(e.tags)?C=e.tags:typeof e.tags=="string"&&(C=e.tags.split(",").map(n=>n.trim()).filter(n=>n.length>0)));const V=p.value.map(n=>{const y=H(n),Q=typeof window<"u"?`${window.location.origin}${O(n)}`:`${h}${O(n)}`,a={"@context":"https://schema.org","@type":"Product",name:n.name,description:n.raw?.description||n.raw?.about||"",image:y?[y]:void 0,url:Q,sku:String(n.id),offers:{"@type":"Offer",price:String(n.price),priceCurrency:"INR",availability:"https://schema.org/InStock",url:Q}};return n.discountPercent&&n.raw?.discounts&&(n.price/(1-n.discountPercent/100),a.offers.price=String(n.price),a.offers.priceSpecification={"@type":"UnitPriceSpecification",price:String(n.price),priceCurrency:"INR",referenceQuantity:{"@type":"QuantitativeValue",value:1,unitCode:"C62"}},a.offers.priceValidUntil=new Date(Date.now()+1440*60*60*1e3).toISOString().split("T")[0]),a.brand={"@type":"Brand",name:"SVRVE"},e.collectionCategory&&(a.category=e.collectionCategory),Object.keys(a).forEach(I=>{a[I]===void 0&&delete a[I]}),a.offers&&Object.keys(a.offers).forEach(I=>{a.offers[I]===void 0&&delete a.offers[I]}),a}),R={"@context":"https://schema.org","@type":e.schemaType||"BlogPosting",headline:e.h1Title||e.title||"Untitled",description:e.metaDescription||(e.content?e.content.replace(/<[^>]*>/g,"").substring(0,200):""),image:q?[q]:void 0,datePublished:e.publishedAt?new Date(e.publishedAt).toISOString():void 0,dateModified:e.updatedAt?new Date(e.updatedAt).toISOString():e.publishedAt?new Date(e.publishedAt).toISOString():void 0,author:{"@type":"Person",name:"Arya Tyagi"},publisher:{"@type":"Organization",name:"SVRVE",url:h,logo:{"@type":"ImageObject",url:`${h}/logo.png`}},mainEntityOfPage:{"@type":"WebPage","@id":e.canonicalUrl||se},articleSection:e.category||void 0,keywords:T.length>0?T.join(", "):void 0,wordCount:W>0?W:void 0,timeRequired:e.readingTime?`PT${e.readingTime}M`:void 0,inLanguage:"en-IN",...C.length>0&&{articleTag:C},...V.length>0&&{mentions:V.map(n=>({"@type":"Product","@id":n.url,name:n.name}))}};Object.keys(R).forEach(n=>{R[n]===void 0&&delete R[n]});const ie={"@context":"https://schema.org","@type":"Organization",name:"SVRVE",url:h,logo:`${h}/logo.png`,sameAs:[]},$=[];M&&$.push({rel:"canonical",href:M}),$.push({rel:"preconnect",href:"https://fonts.googleapis.com"}),$.push({rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""}),$.push({rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"});const J=[{type:"application/ld+json",children:JSON.stringify(R)},{type:"application/ld+json",children:JSON.stringify(ie)}];V.forEach(n=>{J.push({type:"application/ld+json",children:JSON.stringify(n)})}),me({title:i,link:$,meta:d,script:J})},{immediate:!0});const z=e=>String(e||"").toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),H=e=>e.image?k(e.image):"",O=e=>`/product/${z(e.name)}-${e.id}`,re=e=>{const t=Number(e||0);try{return new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(t)}catch{return String(t)}};return(e,t)=>{const i=oe;return l(),c("div",he,[s("div",ye,[_.value?(l(),c("div",ve,[...t[1]||(t[1]=[s("p",{class:"loading-text"},"Loading blog post...",-1)])])):x.value?(l(),c("div",we,[t[2]||(t[2]=s("p",{class:"error-text"},"Failed to load blog post. Please try again later.",-1)),s("button",{class:"retry-btn",type:"button",onClick:t[0]||(t[0]=o=>X())},"Retry")])):r.value?(l(),c("article",_e,[s("div",ke,[Y(i,{to:"/blog",class:"nav-back-btn"},{default:E(()=>[...t[6]||(t[6]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),s("polyline",{points:"12 19 5 12 12 5"})],-1)])]),_:1}),s("button",{class:"nav-share-btn",type:"button",onClick:ne,"aria-label":"Share"},[...t[7]||(t[7]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),s("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})],-1)])])]),r.value.featuredImageUrl?(l(),c("div",$e,[s("img",{src:k(r.value.featuredImageUrl),alt:r.value.title||"Blog featured image",loading:"eager"},null,8,Ie)])):v("",!0),s("div",xe,[s("h1",Ue,w(r.value.h1Title||r.value.title||"Untitled"),1),s("div",Pe,[r.value.publishedAt?(l(),c("span",Te,w(ee(r.value.publishedAt)),1)):v("",!0),r.value.publishedAt&&r.value.readingTime?(l(),c("span",Ce,"•")):v("",!0),r.value.readingTime?(l(),c("span",Re,w(r.value.readingTime)+" min read",1)):v("",!0)]),s("div",{class:"blog-content",innerHTML:D.value},null,8,Ae)])])):(l(),c("div",Se,[t[4]||(t[4]=s("h1",null,"Blog Post Not Found",-1)),t[5]||(t[5]=s("p",null,"The blog post you're looking for doesn't exist.",-1)),Y(i,{to:"/blog",class:"back-link"},{default:E(()=>[...t[3]||(t[3]=[pe("← Back to Blog",-1)])]),_:1})])),r.value&&r.value.collectionCategory&&p.value.length>0?(l(),c("section",Be,[t[8]||(t[8]=s("h2",{class:"related-products-title"},"Related Products",-1)),s("div",Ne,[s("div",{class:"products-carousel",ref_key:"carouselRef",ref:G},[(l(!0),c(ue,null,de(p.value,o=>(l(),ge(i,{key:o.id,to:O(o),class:"product-card"},{default:E(()=>[s("div",Oe,[s("img",{src:H(o),alt:o.name,loading:"lazy"},null,8,Ve),o.discountPercent?(l(),c("span",be,w(o.discountPercent)+"% OFF",1)):v("",!0)]),s("div",Ee,[s("h3",Le,w(o.name),1),s("div",Ke,"Rs. "+w(re(o.price)),1)])]),_:2},1032,["to"]))),128))],512)])])):v("",!0)])])}}},qe=ae(je,[["__scopeId","data-v-77bd2bbb"]]);export{qe as default};
