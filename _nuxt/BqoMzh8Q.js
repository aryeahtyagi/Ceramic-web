import{_ as F}from"./BrXzo5Im.js";import{_ as O}from"./DmoxZqux.js";import{u as C}from"./Bbg1cLgB.js";import{_ as L,u as P,h as R,i as D,q as M,c as a,a as o,b as d,w as _,e as m,F as W,r as q,j as V,g as h,o as n,d as w,t as $}from"./BymtEYvB.js";import{u as j}from"./j9dONU5i.js";const H={class:"orders-page"},T={class:"topbar"},E={class:"content"},z={key:0,class:"loading"},G={key:1,class:"error"},J={key:2,class:"empty"},K={key:3,class:"orders-list"},Q=["src","alt"],X={class:"order-info"},Y={class:"order-price"},Z={__name:"orders",setup(ee){const i=C(),x=P(),B=V(),u=String(B.public.apiBase||"").replace(/\/$/,"");i.isAuthenticated.value||x.push("/login?redirect="+encodeURIComponent("/orders"));const l=h(null),p=h(!1),f=h(null),v=R(()=>{if(!l.value?.orderBooks||!l.value?.ceremics)return[];const e=l.value.orderBooks,t=l.value.ceremics;return e.map(s=>{const c=t.find(r=>r.id===s.productId);return c?{id:s.id,product:c,quantity:s.quantity}:null}).filter(Boolean)}),y=async()=>{if(!i.isAuthenticated.value||!i.user.value)return;const e=i.user.value;p.value=!0,f.value=null;try{const t=new URLSearchParams({id:String(e.id),username:e.username||"",phoneNumber:e.phoneNumber||"",email:e.email||"",address:e.address||"",pincode:e.pincode||""}),s=`${u}/user/orderbook?${t.toString()}`;l.value=await $fetch(s,{method:"POST",headers:{accept:"*/*"}})}catch(t){console.error("[Orders] Failed to load:",t),f.value=t}finally{p.value=!1}},I=e=>String(e||"").toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),b=e=>`/product/${I(e.name)}-${e.id}`,N=e=>new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(Number(e||0)),S=e=>e?.discounts?.enable&&e?.discounts?.discount>0,U=e=>S(e)?Math.round(e.price*(100-(e.discounts.discount||0))/100):e.price,k=e=>{const t=String(e||"").trim();return t?!!t.includes("img.icons8.com"):!1},g=e=>{const t=String(e||"").trim();if(!t||k(t))return"";if(t.includes("localhost:9090")||t.includes("localhost:"))try{const s=new URL(t),c=s.pathname+s.search;return`${u}${c}`}catch{const s=t.match(/localhost:\d+(\/.*)/);return s?`${u}${s[1]}`:t}return t.startsWith("http://")||t.startsWith("https://")?t:t.startsWith("/")?`${u}${t}`:t},A=e=>{if(e.images?.length>0){const t=e.images.find(s=>s.catalogImage);if(t?.imageUrl)return g(t.imageUrl);if(e.images[0]?.imageUrl)return g(e.images[0].imageUrl)}return e.image?.value&&!k(e.image.value)?g(e.image.value):"/images/ceramic-plate.svg"};return D(()=>{i.isAuthenticated.value&&y()}),M(()=>i.isAuthenticated.value,e=>{e?y():l.value=null}),j({title:"My Orders - Ceramic Artistry",meta:[{name:"robots",content:"noindex, nofollow"}]}),(e,t)=>{const s=F,c=O;return n(),a("div",H,[o("header",T,[d(s,{to:"/collections",class:"back","aria-label":"Back to collections"},{default:_(()=>[...t[0]||(t[0]=[w(" â† ",-1)])]),_:1}),t[1]||(t[1]=o("div",{class:"topbar-title"},"My Orders",-1)),d(c)]),o("div",E,[m(p)?(n(),a("div",z,"Loading orders...")):m(f)?(n(),a("div",G,"Failed to load orders. Please try again.")):m(v).length?(n(),a("div",K,[(n(!0),a(W,null,q(m(v),r=>(n(),a("div",{key:r.id,class:"order-item"},[d(s,{to:b(r.product),class:"order-image-wrapper"},{default:_(()=>[o("img",{src:A(r.product),alt:r.product.name,class:"order-image"},null,8,Q)]),_:2},1032,["to"]),o("div",X,[d(s,{to:b(r.product),class:"order-name"},{default:_(()=>[w($(r.product.name),1)]),_:2},1032,["to"]),o("div",Y,"Rs. "+$(N(U(r.product))),1),t[3]||(t[3]=o("div",{class:"order-status"},"Order Confirmed",-1)),t[4]||(t[4]=o("div",{class:"order-timeline"},"Will be delivered to you in a few days (max: 3 days)",-1))])]))),128))])):(n(),a("div",J,[...t[2]||(t[2]=[o("p",null,"No orders found.",-1)])]))])])}}},ne=L(Z,[["__scopeId","data-v-0b3e1fba"]]);export{ne as default};
